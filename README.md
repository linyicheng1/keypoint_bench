# 图像点特征性能指标对比

### 支持的点特征
- ORB
- SIFT
- Harris 
- SuperPoint
- ALIKE
- XFeat
- D2-Net
- DISK
- R2D2
- SFD2

### 支持的匹配方法
- 暴力匹配
- lightglue
- 光流

### 评价指标
- AUC  基于 MegaDepth 数据集
- MHA  基于 Hpatch 数据集
- 重复率 基于 Hpatch 数据集
- 基础矩阵 基于TartanAir数据集
- VO里程计 基于KITTI数据集

### 一些结果

#### 参数

> 值得注意的是，许多论文为了指标更高，往往提取更多的特征，并且非极大值抑制范围很小，这样在实际使用的时候会造成特征扎堆的现象。因此，我们使用的参数都是特征点数量较少，并且非极大值抑制的窗口比较大，这更符合实际情况。**尽管这样往往会导致指标较低。**

##### 特征提取参数
- nms_dist: 6
- min_score: 0.0
- top_k: 1000
- threshold: 0
- border_dist: 8

##### 暴力匹配参数

- metric: euclidean
- max_distance: 5
- cross_check: True

##### 光流匹配参数

- distance: 10
- win_size: 21
- levels: 3
- interation: 40

#### 结果

##### 重复率 

| 特征点 | Harris | ALIKE | SuperPoint | XFeat | D2-Net | DISK | R2D2 | SFD2 | LGood (Ours) | EdgePoint (Ours) |
|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|
| 重复率   | 0.204 | 0.319 | 0.359 | 0.177 |  0.179 | 0.290 | 0.331 | 0.381 | 0.402 | 0.349 | 0.362|
| 平均误差 | 1.861 | 1.317 | 1.466 | 1.508 | 2.022  | 1.473 | 1.483 | 1.507 | 1.447 | 1.390 | 1.366|

##### MHA (暴力匹配)

| 特征点 |  ALIKE | SuperPoint | XFeat | D2-Net | DISK | R2D2 | SFD2 | EdgePoint (Ours) |
|----------|----------|----------|----------|----------|----------|----------|----------|----------|
| MHA@3 | 0.491  | 0.437      | 0.372 | 0.016 | 0.254 | 0.335 | 0.467 | 0.461 |
| MHA@5 | 0.583  | 0.569      | 0.511 | 0.105 | 0.410 | 0.488 | 0.572 | 0.572 |
| MHA@7 | 0.657  | 0.613      | 0.589 | 0.220 | 0.525 | 0.555 | 0.620 | 0.640 |

##### AUC (暴力匹配) MegaDepth

| 特征点 |  ALIKE | SuperPoint | XFeat | D2-Net | DISK | R2D2 | SFD2 | EdgePoint (Ours) |
|----------|----------|----------|----------|----------|----------|----------|----------|----------|
| AUC@5  | 0.375  | 0.192      | 0.200 | 0.126 | 0.249 | 0.247 | 0.295 | 0.304 |
| AUC@10 | 0.527  | 0.323      | 0.351 | 0.240 | 0.403 | 0.360 | 0.442 | 0.448 |
| AUC@20 | 0.661  | 0.461      | 0.516 | 0.386 | 0.562 | 0.464 | 0.578 | 0.581 |


##### 基础矩阵 (光流跟踪) TartanAir

**误差**

| 特征点 |  ALIKE | SuperPoint | XFeat | D2-Net | DISK | R2D2 | SFD2 | EdgePoint (Ours) | LGood (Ours) | LET-NET (Ours) | Harris |
|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|
| MH000 | 9.559  | 9.441      | 9.609 | 9.868 | 9.466 | 9.888 | 9.355 | 9.712           | 7.374       | 0.461          | 0.461 |
| MH001 | 0.583  | 0.569      | 0.511 | 0.105 | 0.41  | 0.488 | 0.572 | 0.572           | 0.461       | 0.461          | 0.461 |
| MH002 | 0.657  | 0.613      | 0.589 | 0.220 | 0.5   | 0.555 | 0.620 | 0.461           | 0.461       | 0.461          | 0.461 |
| MH003 | 0.491  | 0.437      | 0.372 | 0.016 | 0.254 | 0.335 | 0.467 | 0.461           | 0.461       | 0.461          | 0.461 |
| MH004 | 0.583  | 0.569      | 0.511 | 0.105 | 0.41  | 0.488 | 0.572 | 0.572           | 0.461       | 0.461          | 0.461 |
| MH005 | 0.657  | 0.613      | 0.589 | 0.220 | 0.5   | 0.555 | 0.620 | 0.461           | 0.461       | 0.461          | 0.461 |
| MH006 | 0.491  | 0.437      | 0.372 | 0.016 | 0.254 | 0.335 | 0.467 | 0.461           | 0.461       | 0.461          | 0.461 |
| MH007 | 0.583  | 0.569      | 0.511 | 0.105 | 0.41  | 0.488 | 0.572 | 0.572           | 0.461       | 0.461          | 0.461 |
| ME000 | 0.657  | 0.613      | 0.589 | 0.220 | 0.5   | 0.555 | 0.620 | 0.461           | 0.461       | 0.461          | 0.461 |
| ME001 | 6.165  | 6.602      | 6.428 | 6.705 | 5.285 | 6.381 | 6.521 | 6.206           | 6.166       | 5.980          | 6.468 |
| ME002 | 7.383  | 6.583      | 6.934 | 6.423 | 5.832 | 6.563 | 6.487 | 6.535           | 6.055       | 6.154          | 6.514 |
| ME003 | 8.887  | 8.534      | 8.658 | 8.283 | 7.979 | 8.819 | 8.588 | 8.444           | 7.293       | 7.829          | 8.611 |
| ME004 | 8.534  | 8.331      | 8.551 | 8.911 | 7.346 | 8.601 | 8.386 | 0.572           | 0.461       | 0.461          | 0.461 |
| ME005 | 0.657  | 0.613      | 0.589 | 0.220 | 0.5   | 0.555 | 0.620 | 0.461           | 0.461       | 0.461          | 0.461 |
| ME006 | 0.491  | 0.437      | 0.372 | 0.016 | 0.254 | 0.335 | 0.467 | 0.461           | 0.461       | 0.461          | 0.461 |
| ME007 | 0.583  | 0.569      | 0.511 | 0.105 | 0.41  | 0.488 | 0.572 | 0.572           | 0.461       | 0.461          | 0.461 |

**Inlier比例**

| 特征点 |  ALIKE | SuperPoint | XFeat | D2-Net | DISK | R2D2 | SFD2 | EdgePoint (Ours) | LGood (Ours) | LET-NET (Ours) | Harris |
|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|
| MH000 | 0.256  | 0.264      | 0.258 | 0.265 | 0.284 | 0.265 | 0.271 | 0.249          | 0.289        | 0.461          | 0.461 |
| MH001 | 0.583  | 0.569      | 0.511 | 0.105 | 0.41  | 0.488 | 0.572 | 0.572          | 0.461        | 0.461          | 0.461 |
| MH002 | 0.657  | 0.613      | 0.589 | 0.220 | 0.5   | 0.555 | 0.620 | 0.461          | 0.461        | 0.461          | 0.461 |
| MH003 | 0.491  | 0.437      | 0.372 | 0.016 | 0.254 | 0.335 | 0.467 | 0.461          | 0.461        | 0.461          | 0.461 |
| MH004 | 0.583  | 0.569      | 0.511 | 0.105 | 0.41  | 0.488 | 0.572 | 0.572          | 0.461        | 0.461          | 0.461 |
| MH005 | 0.657  | 0.613      | 0.589 | 0.220 | 0.5   | 0.555 | 0.620 | 0.461          | 0.461        | 0.461          | 0.461 |
| MH006 | 0.491  | 0.437      | 0.372 | 0.016 | 0.254 | 0.335 | 0.467 | 0.461          | 0.461        | 0.461          | 0.461 |
| MH007 | 0.583  | 0.569      | 0.511 | 0.105 | 0.41  | 0.488 | 0.572 | 0.572          | 0.461        | 0.461          | 0.461 |
| ME000 | 0.657  | 0.613      | 0.589 | 0.220 | 0.5   | 0.555 | 0.620 | 0.461          | 0.461        | 0.461          | 0.461 |
| ME001 | 0.354  | 0.334      | 0.340 | 0.332 | 0.435 | 0.346 | 0.336 | 0.361          | 0.346        | 0.368          | 0.338 |
| ME002 | 0.357  | 0.365      | 0.361 | 0.379 | 0.414 | 0.368 | 0.370 | 0.359          | 0.372        | 0.369          | 0.377 |
| ME003 | 0.377  | 0.278      | 0.283 | 0.279 | 0.289 | 0.304 | 0.279 | 0.282          | 0.302        | 0.294          | 0.277 |
| ME004 | 0.269  | 0.283      | 0.273 | 0.252 | 0.316 | 0.262 | 0.275 | 0.572          | 0.461        | 0.461          | 0.461 |
| ME005 | 0.657  | 0.613      | 0.589 | 0.220 | 0.5   | 0.555 | 0.620 | 0.461          | 0.461        | 0.461          | 0.461 |
| ME006 | 0.491  | 0.437      | 0.372 | 0.016 | 0.254 | 0.335 | 0.467 | 0.461          | 0.461        | 0.461          | 0.461 |
| ME007 | 0.583  | 0.569      | 0.511 | 0.105 | 0.41  | 0.488 | 0.572 | 0.572          | 0.461        | 0.461          | 0.461 |

##### 基础矩阵 (描述子匹配) TartanAir


| 特征点 |  ALIKE | SuperPoint | XFeat | D2-Net | DISK | R2D2 | SFD2 | EdgePoint (Ours) | 
|----------|----------|----------|----------|----------|----------|----------|----------|----------|
| MH000 | 0.491  | 0.437      | 0.372 | 0.016 | 0.254 | 0.335 | 0.467 | 0.461 |
| MH001 | 0.583  | 0.569      | 0.511 | 0.105 | 0.41  | 0.488 | 0.572 | 0.572 |
| MH002 | 0.657  | 0.613      | 0.589 | 0.220 | 0.5   | 0.555 | 0.620 | 0.461 |
| MH003 | 0.491  | 0.437      | 0.372 | 0.016 | 0.254 | 0.335 | 0.467 | 0.461 |
| MH004 | 0.583  | 0.569      | 0.511 | 0.105 | 0.41  | 0.488 | 0.572 | 0.572 |
| MH005 | 0.657  | 0.613      | 0.589 | 0.220 | 0.5   | 0.555 | 0.620 | 0.461 |
| MH006 | 0.491  | 0.437      | 0.372 | 0.016 | 0.254 | 0.335 | 0.467 | 0.461 |
| MH007 | 0.583  | 0.569      | 0.511 | 0.105 | 0.41  | 0.488 | 0.572 | 0.572 |
| ME000 | 0.657  | 0.613      | 0.589 | 0.220 | 0.5   | 0.555 | 0.620 | 0.461 |
| ME001 | 0.583  | 0.569      | 0.511 | 0.105 | 0.41  | 0.488 | 0.572 | 0.572 |
| ME002 | 0.657  | 0.613      | 0.589 | 0.220 | 0.5   | 0.555 | 0.620 | 0.461 |
| ME003 | 0.491  | 0.437      | 0.372 | 0.016 | 0.254 | 0.335 | 0.467 | 0.461 |
| ME004 | 0.583  | 0.569      | 0.511 | 0.105 | 0.41  | 0.488 | 0.572 | 0.572 |
| ME005 | 0.657  | 0.613      | 0.589 | 0.220 | 0.5   | 0.555 | 0.620 | 0.461 |
| ME006 | 0.491  | 0.437      | 0.372 | 0.016 | 0.254 | 0.335 | 0.467 | 0.461 |
| ME007 | 0.583  | 0.569      | 0.511 | 0.105 | 0.41  | 0.488 | 0.572 | 0.572 |

**Inlier比例**

| 特征点 |  ALIKE | SuperPoint | XFeat | D2-Net | DISK | R2D2 | SFD2 | EdgePoint (Ours) |
|----------|----------|----------|----------|----------|----------|----------|----------|----------|
| MH000 | 0.491  | 0.437      | 0.372 | 0.016 | 0.254 | 0.335 | 0.467 | 0.461 |
| MH001 | 0.583  | 0.569      | 0.511 | 0.105 | 0.41  | 0.488 | 0.572 | 0.572 |
| MH002 | 0.657  | 0.613      | 0.589 | 0.220 | 0.5   | 0.555 | 0.620 | 0.461 |
| MH003 | 0.491  | 0.437      | 0.372 | 0.016 | 0.254 | 0.335 | 0.467 | 0.461 |
| MH004 | 0.583  | 0.569      | 0.511 | 0.105 | 0.41  | 0.488 | 0.572 | 0.572 |
| MH005 | 0.657  | 0.613      | 0.589 | 0.220 | 0.5   | 0.555 | 0.620 | 0.461 |
| MH006 | 0.491  | 0.437      | 0.372 | 0.016 | 0.254 | 0.335 | 0.467 | 0.461 |
| MH007 | 0.583  | 0.569      | 0.511 | 0.105 | 0.41  | 0.488 | 0.572 | 0.572 |
| ME000 | 0.657  | 0.613      | 0.589 | 0.220 | 0.5   | 0.555 | 0.620 | 0.461 |
| ME001 | 0.583  | 0.569      | 0.511 | 0.105 | 0.41  | 0.488 | 0.572 | 0.572 |
| ME002 | 0.657  | 0.613      | 0.589 | 0.220 | 0.5   | 0.555 | 0.620 | 0.461 |
| ME003 | 0.491  | 0.437      | 0.372 | 0.016 | 0.254 | 0.335 | 0.467 | 0.461 |
| ME004 | 0.583  | 0.569      | 0.511 | 0.105 | 0.41  | 0.488 | 0.572 | 0.572 |
| ME005 | 0.657  | 0.613      | 0.589 | 0.220 | 0.5   | 0.555 | 0.620 | 0.461 |
| ME006 | 0.491  | 0.437      | 0.372 | 0.016 | 0.254 | 0.335 | 0.467 | 0.461 |
| ME007 | 0.583  | 0.569      | 0.511 | 0.105 | 0.41  | 0.488 | 0.572 | 0.572 |


##### VO里程计 (光流跟踪) KITTI 


| 特征点 |  ALIKE | SuperPoint | XFeat | D2-Net | DISK | R2D2 | SFD2 | EdgePoint (Ours) | LGood (Ours) | LET-NET (Ours) | Harris |
|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|
| Seq00 | 0.491  | 0.437      | 0.372 | 0.016 | 0.254 | 0.335 | 0.467 | 0.461 | 0.335 | 0.467 | 0.461 |
| Seq01 | 0.583  | 0.569      | 0.511 | 0.105 | 0.410 | 0.488 | 0.572 | 0.572 | 0.335 | 0.467 | 0.461 |
| Seq02 | 0.657  | 0.613      | 0.589 | 0.220 | 0.525 | 0.555 | 0.620 | 0.640 | 0.335 | 0.467 | 0.461 |
| Seq03 | 0.711  | 0.667      | 0.640 | 0.258 | 0.570 | 0.601 | 0.658 | 0.679 | 0.335 | 0.467 | 0.461 |
| Seq04 | 0.745  | 0.702      | 0.673 | 0.288 | 0.603 | 0.633 | 0.688 | 0.709 | 0.335 | 0.467 | 0.461 |
| Seq05 | 0.769  | 0.725      | 0.695 | 0.318 | 0.627 | 0.659 | 0.715 | 0.735 | 0.335 | 0.467 | 0.461 |
| Seq06 | 0.791  | 0.747      | 0.717 | 0.348 | 0.645 | 0.682 | 0.738 | 0.758 | 0.335 | 0.467 | 0.461 |
| Seq07 | 0.815  | 0.771      | 0.748 | 0.378 | 0.663 | 0.701 | 0.759 | 0.779 | 0.335 | 0.467 | 0.461 |
| Seq08 | 0.838  | 0.794      | 0.768 | 0.398 | 0.679 | 0.728 | 0.788 | 0.808 | 0.335 | 0.467 | 0.461 |
| Seq09 | 0.858  | 0.814      | 0.788 | 0.427 | 0.693 | 0.745 | 0.826 | 0.846 | 0.335 | 0.467 | 0.461 |
| Seq10 | 0.878  | 0.834      | 0.808 | 0.456 | 0.710 | 7.472 | 0.865 | 0.885 | 0.335 | 0.467 | 0.461 |


##### VO里程计 (描述子匹配) KITTI 

| 特征点 |  ALIKE | SuperPoint | XFeat | D2-Net | DISK | R2D2 | SFD2 | EdgePoint (Ours) |
|----------|----------|----------|----------|----------|----------|----------|----------|----------|
| Seq00 | 0.491  | 0.437      | 0.372 | 0.016 | 0.254 | 0.335 | 0.467 | 0.461 |
| Seq01 | 0.583  | 0.569      | 0.511 | 0.105 | 0.410 | 0.488 | 0.572 | 0.572 |
| Seq02 | 0.657  | 0.613      | 0.589 | 0.220 | 0.525 | 0.555 | 0.620 | 0.640 |
| Seq03 | 0.711  | 0.667      | 0.640 | 0.258 | 0.570 | 0.601 | 0.658 | 0.679 |
| Seq04 | 0.745  | 0.702      | 0.673 | 0.288 | 0.603 | 0.633 | 0.688 | 0.709 |
| Seq05 | 0.769  | 0.725      | 0.695 | 0.318 | 0.627 | 0.659 | 0.715 | 0.735 |
| Seq06 | 0.791  | 0.747      | 0.717 | 0.348 | 0.645 | 0.682 | 0.738 | 0.758 |
| Seq07 | 0.815  | 0.771      | 0.748 | 0.378 | 0.663 | 0.701 | 0.759 | 0.779 |
| Seq08 | 0.838  | 0.794      | 0.768 | 0.398 | 0.679 | 0.728 | 0.788 | 0.808 |
| Seq09 | 0.858  | 0.814      | 0.788 | 0.427 | 0.693 | 0.745 | 0.826 | 0.846 |
| Seq10 | 0.878  | 0.834      | 0.808 | 0.456 | 0.710 | 7.472 | 0.865 | 0.885 |

## RUN IN Docker 

1. 构造docker镜像

```shell
mkdir keypoint_bench && cd keypoint_bench
wget https://github.com/linyicheng1/keypoint_bench/blob/main/Dockerfile
docker build -t keypoint_bench:v1 .
```

需要等待10-20分钟，下载依赖并且构建镜像

2. 运行docker容器

```shell
docker run -it --gpus all -u root -p 2223:22 -v /数据集下载位置/:/home/data/ keypoint_bench:v1
```

3. 运行python程序

在运行程序前需要修改配置文件中包含的数据集路径，按自己的实际情况修改`/home/code/keypoint_bench/config/config.yaml`文件


运行程序
```shell
cd /home/code/keypoint_bench
python3 main.py --config_file config/config.yaml test 
```

默认得到ALIKE的重复率计算结果

repeatability 0.3157695  rep_mean_err 1.2313193






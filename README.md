# 图像点特征性能指标对比

### 支持的点特征
- ORB
- SIFT
- Harris 
- SuperPoint
- ALIKE
- XFeat
- D2-Net
- DISK
- R2D2
- SFD2

### 支持的匹配方法
- 暴力匹配
- lightglue
- 光流

### 评价指标
- AUC  基于 MegaDepth 数据集
- MHA  基于 Hpatch 数据集
- 重复率 基于 Hpatch 数据集
- 基础矩阵 基于TartanAir数据集
- VO里程计 基于KITTI数据集


## RUN IN Docker 

1. 构造docker镜像

```shell
mkdir keypoint_bench && cd keypoint_bench
wget https://github.com/linyicheng1/keypoint_bench/blob/main/Dockerfile
docker build -t keypoint_bench:v1 .
```

需要等待10-20分钟，下载依赖并且构建镜像

2. 运行docker容器

```shell
docker run -it --gpus all -u root -p 2223:22 -v /数据集下载位置/:/home/data/ keypoint_bench:v1
```

3. 运行python程序

在运行程序前需要修改配置文件中包含的数据集路径，按自己的实际情况修改`/home/code/keypoint_bench/config/config.yaml`文件


运行程序
```shell
cd /home/code/keypoint_bench
python3 main.py --config_file config/config.yaml test 
```

默认得到ALIKE的重复率计算结果

repeatability 0.3157695  rep_mean_err 1.2313193



### 一些结果

#### 参数

> 值得注意的是，许多论文为了指标更高，往往提取更多的特征，并且非极大值抑制范围很小，这样在实际使用的时候会造成特征扎堆的现象。因此，我们使用的参数都是特征点数量较少，并且非极大值抑制的窗口比较大，这更符合实际情况。**尽管这样往往会导致指标较低。**

##### 特征提取参数
- nms_dist: 6
- min_score: 0.0
- top_k: 1000
- threshold: 0
- border_dist: 8

##### 暴力匹配参数

- metric: euclidean
- max_distance: 5
- cross_check: True

##### 光流匹配参数

- distance: 10
- win_size: 21
- levels: 3
- interation: 40

#### 结果

##### 重复率 

| 特征点 | Harris | ALIKE | SuperPoint | XFeat | D2-Net | DISK | R2D2 | SFD2 | LGood (Ours) | EdgePoint (Ours) |
|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|
| 重复率   | 0.204 | 0.319 | 0.359 | 0.177 |  0.179 | 0.290 | 0.331 | 0.381 | 0.402 | 0.349 | 0.362|
| 平均误差 | 1.861 | 1.317 | 1.466 | 1.508 | 2.022  | 1.473 | 1.483 | 1.507 | 1.447 | 1.390 | 1.366|

##### MHA (暴力匹配)

| 特征点 |  ALIKE | SuperPoint | XFeat | D2-Net | DISK | R2D2 | SFD2 | EdgePoint (Ours) |
|----------|----------|----------|----------|----------|----------|----------|----------|----------|
| MHA@3 | 0.491  | 0.437      | 0.372 | 0.016 | 0.254 | 0.335 | 0.467 | 0.461 |
| MHA@5 | 0.583  | 0.569      | 0.511 | 0.105 | 0.410 | 0.488 | 0.572 | 0.572 |
| MHA@7 | 0.657  | 0.613      | 0.589 | 0.220 | 0.525 | 0.555 | 0.620 | 0.640 |

##### AUC (暴力匹配) MegaDepth

| 特征点 |  ALIKE | SuperPoint | XFeat | D2-Net | DISK | R2D2 | SFD2 | EdgePoint (Ours) |
|----------|----------|----------|----------|----------|----------|----------|----------|----------|
| AUC@5  | 0.375  | 0.192      | 0.200 | 0.126 | 0.249 | 0.247 | 0.295 | 0.304 |
| AUC@10 | 0.527  | 0.323      | 0.351 | 0.240 | 0.403 | 0.360 | 0.442 | 0.448 |
| AUC@20 | 0.661  | 0.461      | 0.516 | 0.386 | 0.562 | 0.464 | 0.578 | 0.581 |


##### 基础矩阵 (光流跟踪) TartanAir

**误差**

| 特征点 |  ALIKE | SuperPoint | XFeat | D2-Net | DISK | R2D2 | SFD2 | EdgePoint (Ours) | LGood (Ours) | LET-NET (Ours) | Harris |
|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|
| MH000 | 9.559  | 9.441      | 9.609 | 9.868 | 9.466 | 9.888 | 9.355 | 9.712           | 7.374       | 9.015          | 9.585 |
| MH001 |11.460  |11.719      |12.201 |11.004 | 9.470 |11.784 |11.738 |11.260           | 7.872       | 9.774          |11.376 |
| MH002 | 9.459  | 9.480      | 9.947 | 9.789 | 9.069 | 9.301 | 9.534 | 9.372           | 7.357       | 7.855          | 9.796 |
| MH003 |14.128  |13.837      |14.505 |12.925 |12.871 |13.966 |13.831 |13.573           | 8.649       |10.065          |13.607 |
| MH004 |21.936  |22.745      |22.466 |19.999 |20.051 |21.898 |22.115 |20.900           |10.554       |13.167          |21.654 |
| MH005 | 7.856  | 7.895      | 7.879 | 7.855 | 7.093 | 7.846 | 7.870 | 7.996           | 7.213       | 7.158          | 7.778 |
| MH006 |13.233  |12.846      |13.555 |12.308 |12.698 |13.111 |13.145 |12.763           | 8.304       |10.052          |12.838 |
| MH007 |10.612  |10.599      |10.861 |10.438 | 9.789 |10.659 |10.644 |10.472           | 7.919       | 9.182          |10.618 |
| ME000 | 9.428  | 9.663      | 9.524 |10.130 | 8.842 | 9.795 | 9.380 | 9.319           | 6.540       | 7.896          | 9.301 |
| ME001 | 6.165  | 6.602      | 6.428 | 6.705 | 5.285 | 6.381 | 6.521 | 6.206           | 6.166       | 5.980          | 6.468 |
| ME002 | 7.383  | 6.583      | 6.934 | 6.423 | 5.832 | 6.563 | 6.487 | 6.535           | 6.055       | 6.154          | 6.514 |
| ME003 | 8.887  | 8.534      | 8.658 | 8.283 | 7.979 | 8.819 | 8.588 | 8.444           | 7.293       | 7.829          | 8.611 |
| ME004 | 8.534  | 8.331      | 8.551 | 8.911 | 7.346 | 8.601 | 8.386 | 8.717           | 7.213       | 7.762          | 8.241 |
| ME005 |12.486  |14.145      |13.886 | 9.450 |10.215 |12.963 |11.536 |12.775           | 6.600       | 9.984          |11.732 |
| ME006 | 6.609  | 6.785      | 6.684 | 7.007 | 6.223 | 6.675 | 6.779 | 6.757           | 6.387       | 6.331          | 6.478 |
| ME007 | 9.732  | 9.643      | 9.805 | 9.372 | 9.022 | 9.975 | 9.705 | 9.629           | 7.436       | 8.74           | 9.878 |


##### 基础矩阵 (描述子匹配) TartanAir


| 特征点 |  ALIKE | SuperPoint | XFeat | D2-Net | DISK | R2D2 | SFD2 |
|----------|----------|----------|----------|----------|----------|----------|----------|
| MH000 |104.336 |31.485      |104.114 | 0.395 | 230.685 |202.505 |6.030 |
| MH001 |171.056  |49.141      |121.606 | 0.392 | 236.237 |262.874 |12.700 |
| MH002 |178.670  |18.793      |118.860 | 0.425 |233.026 |256.604 | 5.109 |
| MH003 |101.301 |33.025      |86.855 | 0.337 | 186.509 |178.325 |4.344 | 
| MH004 |98.713  |7.307      |98.488 | 0.376 |243.231 |178.595 |4.478 | 
| MH005 |246.712  |50.350      |144.445 |0.390 |226.917   |270.599 |9.568 | 
| MH006 |163.939  |42.238      |120.138 |0.373 |210.018|233.142 | 8.151 | 
| MH007 |171.425 |43.656      |127.893 |0.393 |245.529 |248.681 | 8.436 | 
| ME000 |121.683  |36.422     |114.715| 0.501 |331.300 |256.842 | 9.606 |
| ME001 |243.317 | 38.217     | 139.288 |0.393 |217.231 |254.585 | 10.482 | 
| ME002 |214.653 | 66.151     | 137.479| 0.449 | 253.256 |283.337 |13.906 | 
| ME003 |122.109 | 24.904      | 85.554 |0.340 | 196.310| 189.215 |7.827 | 
| ME004 | 86.689  |38.143      |131.865 | 0.478 | 265.158  | 221.082 | 3.672 |
| ME005 | 107.440 |14.886      |86.840 | 0.384 | 239.132  | 190.755 | 9.145 |
| ME006 | 231.071  |44.124      |133.078 |0.377 |201.123 |263.733 | 9.126|
| ME007 | 202.551| 28.271     |140.878 | 0.436 | 274.537 | 283.592 |8.675 | 

<!-- 
##### VO里程计 (光流跟踪) KITTI 


| 特征点 |  ALIKE | SuperPoint | XFeat | D2-Net | DISK | R2D2 | SFD2 | EdgePoint (Ours) | LGood (Ours) | LET-NET (Ours) | Harris |
|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|
| Seq00 | 0.491  | 0.437      | 0.372 | 0.016 | 0.254 | 0.335 | 0.467 | 0.461 | 0.335 | 0.467 | 0.461 |
| Seq01 | 0.583  | 0.569      | 0.511 | 0.105 | 0.410 | 0.488 | 0.572 | 0.572 | 0.335 | 0.467 | 0.461 |
| Seq02 | 0.657  | 0.613      | 0.589 | 0.220 | 0.525 | 0.555 | 0.620 | 0.640 | 0.335 | 0.467 | 0.461 |
| Seq03 | 0.711  | 0.667      | 0.640 | 0.258 | 0.570 | 0.601 | 0.658 | 0.679 | 0.335 | 0.467 | 0.461 |
| Seq04 | 0.745  | 0.702      | 0.673 | 0.288 | 0.603 | 0.633 | 0.688 | 0.709 | 0.335 | 0.467 | 0.461 |
| Seq05 | 0.769  | 0.725      | 0.695 | 0.318 | 0.627 | 0.659 | 0.715 | 0.735 | 0.335 | 0.467 | 0.461 |
| Seq06 | 0.791  | 0.747      | 0.717 | 0.348 | 0.645 | 0.682 | 0.738 | 0.758 | 0.335 | 0.467 | 0.461 |
| Seq07 | 0.815  | 0.771      | 0.748 | 0.378 | 0.663 | 0.701 | 0.759 | 0.779 | 0.335 | 0.467 | 0.461 |
| Seq08 | 0.838  | 0.794      | 0.768 | 0.398 | 0.679 | 0.728 | 0.788 | 0.808 | 0.335 | 0.467 | 0.461 |
| Seq09 | 0.858  | 0.814      | 0.788 | 0.427 | 0.693 | 0.745 | 0.826 | 0.846 | 0.335 | 0.467 | 0.461 |
| Seq10 | 0.878  | 0.834      | 0.808 | 0.456 | 0.710 | 7.472 | 0.865 | 0.885 | 0.335 | 0.467 | 0.461 |


##### VO里程计 (描述子匹配) KITTI 

| 特征点 |  ALIKE | SuperPoint | XFeat | D2-Net | DISK | R2D2 | SFD2 |
|----------|----------|----------|----------|----------|----------|----------|----------|
| Seq00 | 0.491  | 0.437      | 0.372 | 0.016 | 0.254 | 0.335 | 0.467 | 0.461 |
| Seq01 | 0.583  | 0.569      | 0.511 | 0.105 | 0.410 | 0.488 | 0.572 | 0.572 |
| Seq02 | 0.657  | 0.613      | 0.589 | 0.220 | 0.525 | 0.555 | 0.620 | 0.640 |
| Seq03 | 0.711  | 0.667      | 0.640 | 0.258 | 0.570 | 0.601 | 0.658 | 0.679 |
| Seq04 | 0.745  | 0.702      | 0.673 | 0.288 | 0.603 | 0.633 | 0.688 | 0.709 |
| Seq05 | 0.769  | 0.725      | 0.695 | 0.318 | 0.627 | 0.659 | 0.715 | 0.735 |
| Seq06 | 0.791  | 0.747      | 0.717 | 0.348 | 0.645 | 0.682 | 0.738 | 0.758 |
| Seq07 | 0.815  | 0.771      | 0.748 | 0.378 | 0.663 | 0.701 | 0.759 | 0.779 |
| Seq08 | 0.838  | 0.794      | 0.768 | 0.398 | 0.679 | 0.728 | 0.788 | 0.808 |
| Seq09 | 0.858  | 0.814      | 0.788 | 0.427 | 0.693 | 0.745 | 0.826 | 0.846 |
| Seq10 | 0.878  | 0.834      | 0.808 | 0.456 | 0.710 | 7.472 | 0.865 | 0.885 |

 -->
